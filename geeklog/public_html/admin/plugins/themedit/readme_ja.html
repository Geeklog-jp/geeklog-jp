<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="ja">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<title>Geeklog テーマエディタプラグイン</title>
	<style type="text/css">
	<!-->
		body {
			color: black;
			background-color: white;
			line-height: 1.5em;
		}
		.geeklog {
			background-color: yellow;
		}
		.public {
			background-color: #99ff00;
		}
		.admin {
			background-color: aqua;
		}
		li {
			padding: 5px 5px 10px 5px;
		}
		h2, h3 {
			padding: 0.3em;
			background-color: #99ff99;
		}
		p {
			text-indent: 1em;
		}
		table {
			border-collapse: collapse;
			border: solid 2px black;
			padding: 0.3em;
		}
		th, td {
			border: solid 1px black;
			padding: 0.3em;
		}
		#copyright {
			padding: 0.5em 1em;
			border: solid 1px aqua;
			background-color: #ccffff;
			font-style: italic;
		}
		.fix {
			color: red;
			font-weight: bold;
		}
		.new {
			color: green;
			font-weight: bold;
		}
	<! -->
	</style>
</head>

<h1>Geeklogテーマエディタプラグイン [v1.0.3]</h1>
by mystral-kk [<a href="mailto:geeklog@mystral-kk.net">geeklog@mystral-kk.net</a>]<br>
2006年11月 7日

<h2>目次</h2>

<ul>
	<li><a href="#description">概要</a></li>
	<li><a href="#version">改訂履歴</a></li>
	<li><a href="#thanks">謝辞</a></li>
	<li><a href="#install">プラグインのインストール</a></li>
	<li><a href="#uninstall">プラグインのアンインストール</a></li>
	<li><a href="#config">プラグインの設定</a></li>
	<li><a href="#upgrade">プラグインのアップグレード</a></li>
	<li><a href="#usage">使用法</a></li>
	<li><a href="#license">ライセンス</a></li>
</ul>

<a name="description"></a><h3>概要</h3>
<p>テーマエディタを使うと，オンラインでテンプレートファイル(*.thtml)とカスケィディングスタイルシートファイル(*.css)を編集できます。このプラグインを使えば，テンプレートファイルを変更する度にアップロードする必要はなくなります。</p>

<a name="version"></a><h3>改訂履歴</h3>
<table border="1">
	<tr>
		<th>日付</th><th>バージョン</th><th>説明</th>
	</tr>
	<tr>
		<td>2006年11月 7日</td><td>1.0.3</td><td><span class="fix">[Fix]</span> デフォルトの言語が日本語の場合に対応(Thanks, Kemal and Tsuchi)。<br><span class="new">[New]</span> テンプレートファイル名を大幅に追加(Thanks, Ivy)。</td>
	</tr>
	<tr>
		<td>2006年11月 2日</td><td>1.0.2</td><td><span class="fix">[Fix]</span> magic_quotes_gpcがオンの場合に対応(Thanks, samstone)。</td>
	</tr>
	<tr>
		<td>2006年10月 1日</td><td>1.0.0</td><td>初期バージョン</td>
	</tr>
</table>

<a name="version"></a><h3>謝辞</h3>
<ul>
	<li>有益なアイデアを提供してくれたGeeklog.jpのメンバーに，</li>
	<li>Geeklogを開発・維持してくれるGeeklogのコア開発チームに，</li>
</ul>
感謝します。

<a name="#install"></a><h3>プラグインのインストール</h3>

<p>以下の説明で，</p>
<ul>
	<li><span class="geeklog">&lt;geeklog_dir&gt;</span>は，システムの config.php が存在するディレクトリ</li>
	<li><span class="admin">&lt;admin&gt;</span>は，管理者用ファイルが存在するディレクトリ（ふつうは，<span class="public">&lt;public_html&gt;</span>ディレクトリの下）</li>
</ul>
<p>を表しています。</p>

<ol>
	<li>テーマエディタプラグインはテーブルを追加するので，管理者メニューの「DBのバックアップ」やphpMyAdminを使用して，事前にGeeklogのデータベースをバックアップしておきます。</li>
	<li>テーマエディタプラグインのアーカイブを<span class="geeklog">&lt;geeklog_dir&gt;</span>/pluginsディレクトリに展開します。themeditという名前のディレクトリができます。</li>
	<li>adminディレクトリを作ります。<span class="admin">&lt;admin&gt;</span>/plugins/ ディレクトリの下に themeditという名前のディレクトリを作ります。</li>
	<li><span class="geeklog">&lt;geeklog_dir&gt;</span>/plugins/themedit/ ディレクトリに移動します。adminディレクトリの内容を，3.で作成した <span class="admin">&lt;admin&gt;</span>/plugins/themedit/ ディレクトリにコピーします。</li>
	<li>themeditディレクトリの config.php ファイルを編集し，データベースのテーブルのプレフィックスと編集対象テーマ，編集対象ファイルなどを設定します。デフォルトでは，Geeklogのテーブルのプレフィックスを使用し，themedit admin以外のアクセスを認めないようになっています。</li>
	<li>Rootユーザーとしてログインし，プラグインエディタからインストールを実行します。失敗した場合には，エラーログ（error.log）を調べます。この時点で，テーマエディタプラグインはインストールされ，機能しているはずです。テーマエディタアイコンをクリックすると，管理機能ページへジャンプするでしょう。</li>
	<li>セキュリティを設定します。インストール直後には，テーマエディタプラグインの管理権限(themedit admin)を持っているのは，Rootユーザーだけです。ユーザーエディタやグループエディタを使用して，管理権限を他の人やグループに委譲することができます</li>
	<li><strong>[***** 注意1 *****]</strong>　編集するテーマが入っているディレクトリのパーミッションを<strong>757</strong>，編集するファイルのパーミッションを<strong>646</strong>に変更する必要があります。</li>
	<li><strong>[***** 注意2 *****]</strong>　<span class="admin">&lt;admin&gt;</span>/plugins/ ディレクトリ内の preview.html と preview.css のパーミッションを<strong>646</strong>に変更する必要があります。</li>
</ol>
<p>注意: テーマエディタプラグインではかなりJavaScriptを使用しています。快適な操作性を得るには，JavaScriptをオンにすることを強くお勧めします。</p>

<a name="#uninstall"></a><h3>プラグインのアンインストール</h3>

<ol>
	<li>プラグインエディタから，テーマエディタプラグインをアンインストールします。このとき，テーマエディタプラグインが使用していたテーブルは破棄され，その中に記録されていたデータも削除されます。</li>
	<li>インストールの過程で作成した 2つのディレクトリ（<span class="geeklog">&lt;geeklog-dir&gt;</span>/plugins/themedit/ と <span class="admin">&lt;admin&gt;</span>/plugins/themedit/ を削除します。</li>
	<li>[***** 注意 *****]</strong>　インストール時に変更したディレクトリとファイルのパーミッションを元に戻します。たとえば，ディレクトリは<strong>755</strong>，ファイルは<strong>644</strong>に変更します。</li>
</ol>

<a name="config"></a><h3>プラグインの設定</h3>
<p>プラグインのconfig.phpでが，次の値を設定できます:</p>
<table border="1">
	<tr>
		<th width="250">変数名</th><th>タイプ</th><th>説明</th>
	</tr>
	<tr>
		<td><code>$_THM_CONF['allowed_themes']</code></td>
		<td>テーマ名の配列</td>
		<td>このプラグインを使用して編集するテーマ名（大文字小文字を区別します）を設定します。デフォルト値は，'professional' です。</td>
	</tr>
	<tr>
		<td><code>$_THM_CONF['allowed_files']</code></td>
		<td>ファイル名の配列</td>
		<td>このプラグインを使用して編集するファイル名（大文字小文字を区別します）を設定します。テンプレートファイル(*.thtml)とカスケィディングスタイルシートファイル(*.css)を指定できます。</td>
	</tr>
	<tr>
		<td><code>$_THM_CONF['resync_database']</code></td>
		<td>'auto', 'manual', 'ignore'のどれか</td>
		<td><code>$_THM_CONF['allowed_themes']</code>にテーマを，<code>$_THM_CONF['allowed_files']</code>にファイルを追加・削除する度に，テーマエディタプラグインは自動的に検出します。<br>
			<ul>
				<li>'auto' -- プラグインはデータベースに保存されているデータを更新します。</li>
				<li>'manual' -- プラグインは更新情報と，「データベースを更新」ボタンを表示します。</li>
				<li>'igonore' -- プラグインは変更を無視します。</li>
			</ul>
		</td>
	</tr>
</table>

<a name="upgrade"></a><h3>プラグインのアップグレード</h3>

<a name="usage"></a><h3>使用法</h3>
<p>テーマエディタプラグインはとてもシンプルなので，ほとんど直感的に使えます。</p>
<ol>
	<li>編集したいテーマをドロップダウンリストから選択します。</li>
	<li>編集したいファイルをドロップダウンリストから選択します。</li>
	<li>使用可能なテンプレート変数の一覧が表示されます。</li>
	<li>テンプレート変数名が書かれたボタンをクリックすると，編集画面のキャレットの位置に対応するタグが挿入されます。<br><strong>注意</strong>: JavaScriptを有効にしないとこのボタンは使えません。</li>
	<li>「プレビュー」ボタンをクリックすると，編集内容のプレビューが別のページで表示されます。</li>
	<li>「保存」ボタンをクリックすると，編集内容がWeb上に保存されます。</li>
	<li>「初期設定に戻す」ボタンをクリックすると，ファイルの内容はこのプラグインがインストールされた時点の内容に戻ります。</li>
</ol>

<a name="license"></a><h3>ライセンス</h3>
<p>テーマエディタプラグインはGPLです。</p>

<div id="copyright">Copyright &copy; 2006 mystral-kk</div>
</body>
</html>
